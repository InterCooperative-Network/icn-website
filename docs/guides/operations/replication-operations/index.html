<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="A substrate daemon for the cooperative internet. DIDs, trust graphs, mutual credit, CCL contracts, and democratic governance — all in one P2P coordination layer."><meta name="theme-color" content="#06090f"><script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://intercooperative.network/#organization","name":"InterCooperative Network","url":"https://intercooperative.network","logo":"https://intercooperative.network/favicon.svg","sameAs":["https://github.com/InterCooperative-Network"]},{"@type":"WebSite","@id":"https://intercooperative.network/#website","url":"https://intercooperative.network","name":"InterCooperative Network","description":"A substrate daemon for the cooperative internet.","publisher":{"@id":"https://intercooperative.network/#organization"}}]}</script><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@600;700;800&display=swap" rel="stylesheet"><title>ICN Replication Operations Guide | InterCooperative Network</title><script>
    // Prevent theme flash
    const theme = (() => {
      if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
        return localStorage.getItem('theme');
      }
      return 'dark';
    })();
    if (theme === 'light') {
      document.documentElement.setAttribute('data-theme', 'light');
    } else {
      document.documentElement.removeAttribute('data-theme');
    }
  </script><link rel="stylesheet" href="/_astro/about.EmGYcvGr.css">
<style>.breadcrumb[data-astro-cid-uadgga6g]{display:flex;align-items:center;gap:var(--space-xs);font-size:.8125rem;margin-bottom:var(--space-lg);flex-wrap:wrap}.breadcrumb[data-astro-cid-uadgga6g] a[data-astro-cid-uadgga6g]{color:var(--accent-teal)}.breadcrumb-sep[data-astro-cid-uadgga6g]{color:var(--text-muted)}.breadcrumb-dir[data-astro-cid-uadgga6g]{color:var(--text-secondary);text-transform:capitalize}.breadcrumb-current[data-astro-cid-uadgga6g]{color:var(--text-primary);text-transform:capitalize}.doc-meta[data-astro-cid-uadgga6g]{margin-bottom:var(--space-xl);padding-bottom:var(--space-md);border-bottom:1px solid var(--border-subtle)}.source-link[data-astro-cid-uadgga6g]{font-size:.8125rem;color:var(--text-muted)}.source-link[data-astro-cid-uadgga6g]:hover{color:var(--accent-teal)}.doc-footer[data-astro-cid-uadgga6g]{margin-top:var(--space-3xl);padding-top:var(--space-xl);border-top:1px solid var(--border-subtle)}
</style></head> <body> <!-- Navigation --> <nav class="nav" id="main-nav"> <div class="nav-inner"> <a href="/" class="nav-logo"> <svg class="nav-logo-svg" width="28" height="28" viewBox="0 0 128 128" fill="none"> <rect width="128" height="128" rx="28" fill="url(#nav-bg)"></rect> <line x1="64" y1="30" x2="34" y2="82" stroke="url(#nav-teal)" stroke-width="4" stroke-linecap="round" opacity="0.6"></line> <line x1="64" y1="30" x2="94" y2="82" stroke="url(#nav-teal)" stroke-width="4" stroke-linecap="round" opacity="0.6"></line> <line x1="34" y1="82" x2="94" y2="82" stroke="url(#nav-teal)" stroke-width="4" stroke-linecap="round" opacity="0.6"></line> <circle cx="64" cy="30" r="11" fill="url(#nav-teal)"></circle> <circle cx="34" cy="82" r="11" fill="url(#nav-teal)"></circle> <circle cx="94" cy="82" r="11" fill="url(#nav-teal)"></circle> <circle cx="64" cy="64" r="4" fill="url(#nav-teal)" opacity="0.8"></circle> <defs> <linearGradient id="nav-bg" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#0f2027"></stop><stop offset="1" stop-color="#0a1628"></stop></linearGradient> <linearGradient id="nav-teal" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#2dd4bf"></stop><stop offset="1" stop-color="#38bdf8"></stop></linearGradient> </defs> </svg> <span>ICN</span> </a> <ul class="nav-links" id="nav-links"> <li><a href="/about">About</a></li> <li><a href="/docs" class="active">Docs</a></li> <li><a href="/architecture">Architecture</a></li> <li><a href="/roadmap">Roadmap</a></li> <li><a href="/community">Community</a></li> <li><a href="/blog">Blog</a></li> </ul> <div class="nav-cta"> <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme" data-astro-cid-x3pjskd3> <svg class="sun-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-x3pjskd3><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" data-astro-cid-x3pjskd3></path></svg> <svg class="moon-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-x3pjskd3><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" data-astro-cid-x3pjskd3></path></svg> </button>  <script>
  const theme = (() => {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      return localStorage.getItem('theme');
    }
    return 'dark';
  })();

  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
  } else {
    document.documentElement.removeAttribute('data-theme');
  }

  window.localStorage.setItem('theme', theme);

  const handleToggleClick = () => {
    const element = document.documentElement;
    if (element.getAttribute('data-theme') === 'light') {
      element.removeAttribute('data-theme');
      localStorage.setItem('theme', 'dark');
    } else {
      element.setAttribute('data-theme', 'light');
      localStorage.setItem('theme', 'light');
    }
  };

  document.getElementById('theme-toggle')?.addEventListener('click', handleToggleClick);
</script> <a href="https://github.com/InterCooperative-Network/icn" target="_blank" rel="noopener" class="nav-github" aria-label="GitHub"> <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"></path></svg> </a> <a href="/docs/GETTING_STARTED" class="btn btn-primary btn-sm">Get Started</a> </div> <button class="nav-toggle" id="nav-toggle" aria-label="Toggle menu"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"></path></svg> </button> </div> </nav> <!-- Main Content --> <main>  <section class="section" style="padding-top: calc(64px + var(--space-2xl));" data-astro-cid-uadgga6g> <div class="container-narrow" data-astro-cid-uadgga6g> <!-- Breadcrumb --> <nav class="breadcrumb" data-astro-cid-uadgga6g> <a href="/docs" data-astro-cid-uadgga6g>Docs</a> <span class="breadcrumb-sep" data-astro-cid-uadgga6g>/</span>
          <span class="breadcrumb-dir" data-astro-cid-uadgga6g>guides</span><span class="breadcrumb-sep" data-astro-cid-uadgga6g>/</span>
          <span class="breadcrumb-dir" data-astro-cid-uadgga6g>operations</span> <span class="breadcrumb-sep" data-astro-cid-uadgga6g>/</span> <span class="breadcrumb-current" data-astro-cid-uadgga6g>replication operations</span> </nav> <!-- Source link --> <div class="doc-meta" data-astro-cid-uadgga6g> <a href="https://github.com/InterCooperative-Network/icn/blob/main/guides/operations/replication-operations.md" target="_blank" class="source-link" data-astro-cid-uadgga6g>
View source on GitHub →
</a> </div> <!-- Rendered markdown --> <article class="prose" data-astro-cid-uadgga6g><h1>ICN Replication Operations Guide</h1>
<p><strong>Phase 17: Storage Hardening &amp; Replication</strong>
<strong>Version</strong>: 1.0
<strong>Last Updated</strong>: 2025-11-24</p>
<h2>Overview</h2>
<p>ICN&#39;s replication system provides fault-tolerant data storage through trust-weighted peer replication. This guide covers configuration, monitoring, and troubleshooting for production deployments.</p>
<h2>Architecture</h2>
<h3>Components</h3>
<ol>
<li><p><strong>ReplicationManager Actor</strong></p>
<ul>
<li>Background health monitoring (runs every 60 seconds by default)</li>
<li>Detects under-replicated content (count &lt; target)</li>
<li>Selects trusted peers for replication</li>
<li>Sends replica requests via gossip protocol</li>
</ul>
</li>
<li><p><strong>Gossip Protocol Extensions</strong></p>
<ul>
<li><code>ReplicaRequest</code>: Request peers to store content</li>
<li><code>ReplicaOffer</code>: Peer confirms willingness to replicate</li>
<li><code>ReplicaStatus</code>: Batch health status updates</li>
</ul>
</li>
<li><p><strong>Storage Layer</strong></p>
<ul>
<li>Replica metadata tracking per content hash</li>
<li>Health status: Healthy, Stale, Unreachable</li>
<li>Last-seen timestamps for staleness detection</li>
</ul>
</li>
</ol>
<h3>Data Flow</h3>
<pre><code>Content Published
    ↓
ReplicationManager detects under-replication
    ↓
Select trusted peers (trust-weighted)
    ↓
Send ReplicaRequest via gossip
    ↓
Peers respond with ReplicaOffer
    ↓
Metadata updated in store
    ↓
Health monitoring continues (60s loop)
</code></pre>
<h2>Configuration</h2>
<h3>Default Configuration</h3>
<p>The ReplicationManager uses sensible defaults suitable for most deployments:</p>
<pre><code class="language-rust">ReplicationConfig {
    target_replicas: 3,                    // Aim for 3 copies
    min_trust_class: TrustClass::Partner,  // Require Partner+ trust (0.4+)
    health_check_interval_secs: 60,        // Check every minute
    stale_threshold_secs: 300,             // 5 minutes = Stale
    unreachable_threshold_secs: 900,       // 15 minutes = Unreachable
}
</code></pre>
<h3>Custom Configuration</h3>
<p>For production environments with specific requirements, configure via environment or code:</p>
<h4>Environment Variables</h4>
<pre><code class="language-bash"># Increase replica target for critical data
export ICN_REPLICATION_TARGET_REPLICAS=5

# Require higher trust for replicas
export ICN_REPLICATION_MIN_TRUST_CLASS=Federated

# More frequent health checks
export ICN_REPLICATION_HEALTH_CHECK_INTERVAL_SECS=30
</code></pre>
<h4>Programmatic Configuration</h4>
<pre><code class="language-rust">use icn_core::ReplicationConfig;
use icn_trust::TrustClass;

let config = ReplicationConfig {
    target_replicas: 5,
    min_trust_class: TrustClass::Federated,
    health_check_interval_secs: 30,
    stale_threshold_secs: 600,              // 10 minutes
    unreachable_threshold_secs: 1800,       // 30 minutes
};

// ReplicationManager spawned with custom config in supervisor
</code></pre>
<h2>Trust Classes and Selection</h2>
<h3>Trust Class Hierarchy</h3>
<table>
<thead>
<tr>
<th>Trust Class</th>
<th>Score Range</th>
<th>Typical Relationship</th>
</tr>
</thead>
<tbody><tr>
<td>Isolated</td>
<td>0.0 - 0.1</td>
<td>Unknown, untrusted</td>
</tr>
<tr>
<td>Known</td>
<td>0.1 - 0.4</td>
<td>Basic interaction</td>
</tr>
<tr>
<td><strong>Partner</strong></td>
<td><strong>0.4 - 0.7</strong></td>
<td><strong>Default minimum for replicas</strong></td>
</tr>
<tr>
<td>Federated</td>
<td>0.7 - 1.0</td>
<td>Deep collaboration</td>
</tr>
</tbody></table>
<h3>Selection Algorithm</h3>
<p>When ReplicationManager detects under-replication:</p>
<ol>
<li><strong>Query gossip for known peers</strong> (subscribers + vector clock peers)</li>
<li><strong>Filter by minimum trust class</strong> (default: Partner+)</li>
<li><strong>Exclude existing replicas</strong> (avoid duplicates)</li>
<li><strong>Sort by trust score</strong> (descending - higher trust first)</li>
<li><strong>Select top N candidates</strong> (limit to 5 requests per check)</li>
</ol>
<p><strong>Example:</strong></p>
<pre><code>Peers:
- Alice: trust=0.2 (Known) → REJECTED (below Partner threshold)
- Bob: trust=0.5 (Partner) → Selected #3
- Carol: trust=0.6 (Partner) → Selected #2
- Dave: trust=0.8 (Federated) → Selected #1 (highest trust)

Request order: Dave, Carol, Bob (up to 5 total)
</code></pre>
<h2>Health Monitoring</h2>
<h3>Health States</h3>
<table>
<thead>
<tr>
<th>State</th>
<th>Condition</th>
<th>Action</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Healthy</strong></td>
<td>last_seen &lt; 5 minutes</td>
<td>Normal operation</td>
</tr>
<tr>
<td><strong>Stale</strong></td>
<td>last_seen 5-15 minutes</td>
<td>Warning, may need refresh</td>
</tr>
<tr>
<td><strong>Unreachable</strong></td>
<td>last_seen &gt; 15 minutes</td>
<td>Likely offline, trigger re-replication</td>
</tr>
</tbody></table>
<h3>Monitoring Loop</h3>
<p>Every 60 seconds (configurable), ReplicationManager:</p>
<ol>
<li>Loads all content hashes with replica metadata</li>
<li>For each content hash:<ul>
<li>Updates replica health based on last_seen timestamps</li>
<li>Counts healthy replicas</li>
<li>If count &lt; target_replicas: trigger re-replication</li>
</ul>
</li>
<li>Logs health check results</li>
</ol>
<h3>Request Rate Limiting</h3>
<p>To avoid spam, ReplicationManager tracks recent requests:</p>
<ul>
<li><strong>Cooldown period</strong>: 5 minutes minimum between requests for same content</li>
<li><strong>Request limit</strong>: 5 peers per health check cycle</li>
<li><strong>Exponential backoff</strong>: If no candidates found, wait before retrying</li>
</ul>
<h2>Prometheus Metrics</h2>
<h3>Current Metrics (Week 3)</h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>icn_replication_health_checks_total</code></td>
<td>Counter</td>
<td>Total health checks run</td>
</tr>
<tr>
<td><code>icn_replication_under_replicated_total</code></td>
<td>Counter</td>
<td>Content items below target</td>
</tr>
<tr>
<td><code>icn_replication_requests_sent_total</code></td>
<td>Counter</td>
<td>Replica requests sent</td>
</tr>
</tbody></table>
<h3>Planned Metrics (Week 4)</h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>icn_replication_replica_count{content_hash}</code></td>
<td>Gauge</td>
<td>Current replica count per hash</td>
</tr>
<tr>
<td><code>icn_replication_health_check_duration_seconds</code></td>
<td>Histogram</td>
<td>Health check execution time</td>
</tr>
<tr>
<td><code>icn_replication_offers_received_total</code></td>
<td>Counter</td>
<td>Replica offers from peers</td>
</tr>
<tr>
<td><code>icn_replication_failures_total{reason}</code></td>
<td>Counter</td>
<td>Failed replication attempts</td>
</tr>
</tbody></table>
<h3>Monitoring Dashboard (Example)</h3>
<pre><code class="language-promql"># Under-replicated content alert
rate(icn_replication_under_replicated_total[5m]) &gt; 0

# Average replica count across all content
avg(icn_replication_replica_count)

# Replication request success rate
rate(icn_replication_offers_received_total[5m])
  / rate(icn_replication_requests_sent_total[5m])
</code></pre>
<h2>Operational Procedures</h2>
<h3>Checking Replication Health</h3>
<p><strong>Via Prometheus:</strong></p>
<pre><code class="language-bash">curl http://localhost:9100/metrics | grep icn_replication
</code></pre>
<p><strong>Via Logs:</strong></p>
<pre><code class="language-bash"># Look for health check summaries
journalctl -u icnd | grep &quot;Replication health check complete&quot;

# Example output:
# Replication health check complete: 127 healthy, 3 under-replicated
</code></pre>
<h3>Increasing Replica Count</h3>
<p>If data loss is a concern, increase target replicas:</p>
<p><strong>Method 1: Environment Variable (restart required)</strong></p>
<pre><code class="language-bash">export ICN_REPLICATION_TARGET_REPLICAS=5
systemctl restart icnd
</code></pre>
<p><strong>Method 2: Runtime Configuration (future)</strong></p>
<pre><code class="language-bash"># Planned for Phase 18
icnctl replication set-target 5
</code></pre>
<h3>Handling Under-Replication Alerts</h3>
<p><strong>Diagnosis:</strong></p>
<ol>
<li>Check peer connectivity: <code>icnctl network peers</code></li>
<li>Check trust relationships: <code>icnctl trust list</code></li>
<li>Check recent replica requests in logs</li>
</ol>
<p><strong>Resolution:</strong></p>
<ul>
<li><strong>No trusted peers</strong>: Add trust relationships with <code>icnctl trust attest</code></li>
<li><strong>Peers offline</strong>: Wait for peers to reconnect, or find new peers</li>
<li><strong>Insufficient capacity</strong>: Peers may be at storage limits (Phase 18: quotas)</li>
</ul>
<h3>Manual Re-Replication (Emergency)</h3>
<p>If automatic re-replication fails:</p>
<pre><code class="language-bash"># Force health check (triggers re-replication immediately)
# Planned for Phase 17 Week 4
icnctl replication health-check

# Query replica status for specific content
icnctl replication status &lt;content_hash&gt;

# Manually request replica from specific peer
icnctl replication request &lt;content_hash&gt; &lt;peer_did&gt;
</code></pre>
<h2>Troubleshooting</h2>
<h3>Symptom: Replication requests never sent</h3>
<p><strong>Possible Causes:</strong></p>
<ul>
<li>No trusted peers at Partner+ level</li>
<li>All peers already have replicas</li>
<li>Request cooldown period active (5 minute minimum)</li>
</ul>
<p><strong>Diagnosis:</strong></p>
<pre><code class="language-bash"># Check trust graph
icnctl trust list

# Check known peers
icnctl network peers

# Check recent requests in logs
journalctl -u icnd | grep &quot;ReplicaRequest&quot;
</code></pre>
<p><strong>Solution:</strong></p>
<ul>
<li>Add trust relationships with peers</li>
<li>Lower min_trust_class (not recommended for production)</li>
<li>Wait for cooldown period to expire</li>
</ul>
<h3>Symptom: High under-replication count</h3>
<p><strong>Possible Causes:</strong></p>
<ul>
<li>Network partition (peers offline)</li>
<li>Storage capacity exhaustion (Phase 18)</li>
<li>Insufficient trusted peers in network</li>
</ul>
<p><strong>Diagnosis:</strong></p>
<pre><code class="language-bash"># Check network connectivity
ping &lt;peer_ip&gt;
icnctl network dial &lt;peer_did&gt;

# Check peer trust levels
icnctl trust compute &lt;peer_did&gt;
</code></pre>
<p><strong>Solution:</strong></p>
<ul>
<li>Increase target_replicas temporarily to spread load</li>
<li>Add more high-trust peers to network</li>
<li>Investigate peer storage capacity (Phase 18: quotas)</li>
</ul>
<h3>Symptom: Replicas marked as Stale/Unreachable</h3>
<p><strong>Possible Causes:</strong></p>
<ul>
<li>Peer temporarily offline (network issue)</li>
<li>Peer crashed (process died)</li>
<li>Clock drift (timestamps incorrect)</li>
</ul>
<p><strong>Diagnosis:</strong></p>
<pre><code class="language-bash"># Check if peer is responsive
icnctl network ping &lt;peer_did&gt;

# Check peer&#39;s last message timestamp
journalctl -u icnd | grep &lt;peer_did&gt;
</code></pre>
<p><strong>Solution:</strong></p>
<ul>
<li>Wait for peer to reconnect (automatic health recovery)</li>
<li>If peer permanently offline, ReplicationManager will request new replicas</li>
<li>Check system clocks (Phase 19: clock synchronization)</li>
</ul>
<h2>Best Practices</h2>
<h3>Production Deployments</h3>
<ol>
<li><p><strong>Set target_replicas ≥ 3</strong></p>
<ul>
<li>Survives single node failure</li>
<li>99.9% durability with proper distribution</li>
</ul>
</li>
<li><p><strong>Maintain Partner+ trust with multiple peers</strong></p>
<ul>
<li>Minimum 5 Partner+ peers for redundancy</li>
<li>Distribute peers across regions/operators</li>
</ul>
</li>
<li><p><strong>Monitor under-replication alerts</strong></p>
<ul>
<li>Alert when under-replication &gt; 5% of content</li>
<li>Daily health check summaries</li>
</ul>
</li>
<li><p><strong>Regular trust graph maintenance</strong></p>
<ul>
<li>Review trust relationships quarterly</li>
<li>Remove trust for inactive peers</li>
<li>Add trust for new collaborators</li>
</ul>
</li>
</ol>
<h3>Development/Testing</h3>
<ol>
<li><p><strong>Use lower health_check_interval_secs</strong></p>
<ul>
<li>10-30 seconds for faster iteration</li>
<li>Reset to 60s for production</li>
</ul>
</li>
<li><p><strong>Use lower target_replicas</strong></p>
<ul>
<li>2 replicas sufficient for testing</li>
<li>Reduces resource usage in dev environments</li>
</ul>
</li>
<li><p><strong>Test failure scenarios</strong></p>
<ul>
<li>Kill node processes (simulate crash)</li>
<li>Partition networks (simulate network failure)</li>
<li>Verify automatic recovery</li>
</ul>
</li>
</ol>
<h2>Performance Considerations</h2>
<h3>Network Overhead</h3>
<p>Each replica request incurs:</p>
<ul>
<li>1 ReplicaRequest message (~100 bytes)</li>
<li>1 ReplicaOffer response (~150 bytes)</li>
<li>Total: ~250 bytes per request</li>
</ul>
<p><strong>Typical overhead for 100 content items:</strong></p>
<ul>
<li>100 items × 2 under-replicated × 3 requests/item = 600 requests</li>
<li>600 requests × 250 bytes = 150 KB bandwidth</li>
<li>Spread over 60 seconds = 2.5 KB/sec (negligible)</li>
</ul>
<h3>Storage Overhead</h3>
<p>Replica metadata per content hash:</p>
<ul>
<li>Content hash: 32 bytes</li>
<li>Per-replica: ~80 bytes (DID + timestamp + health)</li>
<li>Total: 32 + (80 × replicas) bytes</li>
</ul>
<p><strong>Example for 1,000 content items with 3 replicas each:</strong></p>
<ul>
<li>1,000 × (32 + 80×3) = 272 KB metadata</li>
<li>Negligible compared to actual content size</li>
</ul>
<h3>CPU Overhead</h3>
<p>Health check cycle (every 60 seconds):</p>
<ul>
<li>Load all replica metadata: ~1ms per 100 items</li>
<li>Trust score lookups: ~10ms per 100 peers</li>
<li>Total: ~11ms per cycle (0.018% CPU usage)</li>
</ul>
<h2>Security Considerations</h2>
<h3>Trust Requirements</h3>
<p><strong>Why Partner+ trust for replicas?</strong></p>
<ul>
<li>Prevents Sybil attacks (fake nodes offering replicas)</li>
<li>Ensures data stored with reliable, known peers</li>
<li>Maintains consistency with trust graph semantics</li>
</ul>
<p><strong>Lowering min_trust_class risks:</strong></p>
<ul>
<li>Known (0.1-0.4): Higher risk of unreliable replicas</li>
<li>Isolated (0.0-0.1): <strong>NOT RECOMMENDED</strong> - no trust relationship</li>
</ul>
<h3>Replica Verification</h3>
<p><strong>Current (Phase 17):</strong></p>
<ul>
<li>Trust-based replica selection</li>
<li>Health monitoring via last_seen timestamps</li>
</ul>
<p><strong>Future (Phase 18):</strong></p>
<ul>
<li>Cryptographic verification of stored content</li>
<li>Challenge-response proofs of storage</li>
<li>Byzantine fault detection for corrupt replicas</li>
</ul>
<h2>Future Enhancements</h2>
<h3>Phase 18: Pre-Pilot Hardening</h3>
<ul>
<li><strong>Storage quotas</strong>: Per-peer capacity limits</li>
<li><strong>Byzantine detection</strong>: Identify corrupt/malicious replicas</li>
<li><strong>Conflict resolution</strong>: Handle replica disagreements</li>
</ul>
<h3>Phase 19: Post-Pilot Improvements</h3>
<ul>
<li><strong>Geo-diverse replication</strong>: Spread replicas across regions</li>
<li><strong>Erasure coding</strong>: N-of-M recovery (reduce storage 3x)</li>
<li><strong>Priority-based replication</strong>: Critical data replicated first</li>
</ul>
<h2>Related Documentation</h2>
<ul>
<li><a href="https://github.com/InterCooperative-Network/icn/blob/main/ARCHITECTURE#74-data-durability--replication#74-data-durability--replication">ARCHITECTURE.md Section 7.4</a> - Technical design</li>
<li><a href="https://github.com/InterCooperative-Network/icn/blob/main/docs/development/sessions/undated/ROADMAP#phase-17-storage-hardening--replication-4-weeks#phase-17-storage-hardening--replication-4-weeks">ROADMAP.md Phase 17</a> - Implementation timeline</li>
<li><a href="https://github.com/InterCooperative-Network/icn/blob/main/CHANGELOG">CHANGELOG.md</a> - Release notes</li>
</ul>
<h2>Support</h2>
<p>For operational questions or issues:</p>
<ul>
<li>GitHub Issues: <a href="https://github.com/InterCooperative-Network/icn/issues" target="_blank" rel="noopener">https://github.com/InterCooperative-Network/icn/issues</a></li>
<li>Development sessions: <code>docs/development/sessions/</code> (detailed implementation notes)</li>
<li>Metrics dashboard: <code>http://localhost:9100/metrics</code> (Prometheus)</li>
</ul>
<hr>
<p><strong>Document Version</strong>: 1.0 (Phase 17 Week 4)
<strong>Next Review</strong>: After Phase 17 completion and pilot deployment feedback</p>
</article> <!-- Footer nav --> <div class="doc-footer" data-astro-cid-uadgga6g> <a href="/docs" class="btn btn-ghost" data-astro-cid-uadgga6g>← Back to Docs</a> </div> </div> </section>  </main> <!-- Footer --> <footer class="footer"> <div class="container"> <div class="footer-inner"> <div class="footer-brand"> <a href="/" class="nav-logo"> <svg class="nav-logo-svg" width="28" height="28" viewBox="0 0 128 128" fill="none"> <rect width="128" height="128" rx="28" fill="url(#ft-bg)"></rect> <line x1="64" y1="30" x2="34" y2="82" stroke="url(#ft-teal)" stroke-width="4" stroke-linecap="round" opacity="0.6"></line> <line x1="64" y1="30" x2="94" y2="82" stroke="url(#ft-teal)" stroke-width="4" stroke-linecap="round" opacity="0.6"></line> <line x1="34" y1="82" x2="94" y2="82" stroke="url(#ft-teal)" stroke-width="4" stroke-linecap="round" opacity="0.6"></line> <circle cx="64" cy="30" r="11" fill="url(#ft-teal)"></circle> <circle cx="34" cy="82" r="11" fill="url(#ft-teal)"></circle> <circle cx="94" cy="82" r="11" fill="url(#ft-teal)"></circle> <circle cx="64" cy="64" r="4" fill="url(#ft-teal)" opacity="0.8"></circle> <defs> <linearGradient id="ft-bg" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#0f2027"></stop><stop offset="1" stop-color="#0a1628"></stop></linearGradient> <linearGradient id="ft-teal" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#2dd4bf"></stop><stop offset="1" stop-color="#38bdf8"></stop></linearGradient> </defs> </svg> <span>InterCooperative Network</span> </a> <p>A substrate daemon for the cooperative internet. Infrastructure for cooperatives, communities, and federations.</p> </div> <div class="footer-col"> <h4>Project</h4> <ul> <li><a href="/about">About</a></li> <li><a href="/docs">Documentation</a></li> <li><a href="/architecture">Architecture</a></li> <li><a href="/roadmap">Roadmap</a></li> </ul> </div> <div class="footer-col"> <h4>Resources</h4> <ul> <li><a href="/docs/GETTING_STARTED">Getting Started</a></li> <li><a href="/docs/glossary">Glossary</a></li> <li><a href="/docs/CONTRIBUTING">Contributing</a></li> <li><a href="https://github.com/InterCooperative-Network/icn/discussions" target="_blank">Discussions</a></li> </ul> </div> <div class="footer-col"> <h4>Community</h4> <ul> <li><a href="https://github.com/InterCooperative-Network/icn" target="_blank">GitHub</a></li> <li><a href="https://github.com/InterCooperative-Network/icn/issues" target="_blank">Issues</a></li> <li><a href="/community">Community</a></li> </ul> </div> </div> <div class="footer-bottom"> <span>AGPL-3.0 License · InterCooperative Network</span> <span>Built with cooperation, not extraction</span> </div> </div> </footer> <script>
    // Mobile nav toggle
    document.getElementById('nav-toggle')?.addEventListener('click', () => {
      document.getElementById('nav-links')?.classList.toggle('open');
    });

    // Scroll-reveal animations
    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('revealed');
          revealObserver.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });

    document.querySelectorAll('.card, .section-header, .arch-box, .stage-item, .docs-section-card, .primitive').forEach(el => {
      el.classList.add('reveal');
      revealObserver.observe(el);
    });
  </script> </body> </html> 