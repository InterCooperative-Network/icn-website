---
// src/components/NavBar.astro
const navLinks = [
  { href: "/about", text: "About" },
  { href: "/use-cases", text: "Use Cases" },
  { href: "/roadmap", text: "Roadmap" },
  { href: "/docs", text: "Docs" },
  { href: "/community", text: "Community" },
];

const moreLinks = [
  { href: "/governance", text: "Governance" },
  { href: "/infrastructure", text: "Infrastructure" },
  { href: "/projects", text: "Projects" },
  { href: "/join", text: "Join" },
  { href: "/blog", text: "Blog" },
];
---

<header class="nav-header">
  <div class="container mx-auto flex items-center justify-between h-16 px-4 lg:px-6">
    <!-- Logo -->
    <a href="/" class="nav-logo group">
      <div class="logo-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 12a4.5 4.5 0 014.5-4.5M7.5 12a4.5 4.5 0 004.5 4.5m4.5-4.5a4.5 4.5 0 01-4.5 4.5m4.5-4.5a4.5 4.5 0 00-4.5-4.5" />
        </svg>
      </div>
      <span class="logo-text">ICN</span>
    </a>

    <!-- Desktop Navigation -->
    <nav class="hidden lg:flex items-center gap-1">
      {navLinks.map(link => (
        <a
          href={link.href}
          class="nav-link"
          aria-current={Astro.url.pathname === link.href ? "page" : undefined}
        >
          {link.text}
        </a>
      ))}

      <!-- More dropdown -->
      <div class="nav-dropdown">
        <button class="nav-link nav-dropdown-trigger" aria-expanded="false">
          More
          <svg class="w-4 h-4 ml-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>
        <div class="nav-dropdown-menu">
          {moreLinks.map(link => (
            <a
              href={link.href}
              class="nav-dropdown-item"
              aria-current={Astro.url.pathname === link.href ? "page" : undefined}
            >
              {link.text}
            </a>
          ))}
        </div>
      </div>
    </nav>

    <!-- Right side: GitHub + Mobile menu -->
    <div class="flex items-center gap-3">
      <!-- GitHub link -->
      <a
        href="https://github.com/InterCooperative-Network/icn"
        class="nav-github"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="View on GitHub"
      >
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
        </svg>
      </a>

      <!-- Mobile Menu Button -->
      <button id="menu-toggle" class="lg:hidden nav-mobile-toggle" aria-label="Open menu" aria-expanded="false" aria-controls="mobile-menu">
        <svg id="menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
        <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="mobile-menu">
    <div class="mobile-menu-content">
      <div class="mobile-menu-section">
        {[...navLinks, ...moreLinks].map(link => (
          <a
            href={link.href}
            class="mobile-menu-link"
            aria-current={Astro.url.pathname === link.href ? "page" : undefined}
          >
            {link.text}
          </a>
        ))}
      </div>

      <div class="mobile-menu-footer">
        <a
          href="https://github.com/InterCooperative-Network/icn"
          class="mobile-menu-cta"
          target="_blank"
          rel="noopener noreferrer"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
          </svg>
          View on GitHub
        </a>
      </div>
    </div>
  </div>
</header>

<script>
  // Mobile Menu Toggle
  document.addEventListener('DOMContentLoaded', function() {
    const menuToggle = document.getElementById('menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIcon = document.getElementById('menu-icon');
    const closeIcon = document.getElementById('close-icon');
    let isOpen = false;

    function toggleMenu() {
      isOpen = !isOpen;

      if (isOpen) {
        mobileMenu?.classList.add('open');
        menuIcon?.classList.add('hidden');
        closeIcon?.classList.remove('hidden');
        document.body.classList.add('mobile-menu-open');
        menuToggle?.setAttribute('aria-expanded', 'true');
      } else {
        mobileMenu?.classList.remove('open');
        menuIcon?.classList.remove('hidden');
        closeIcon?.classList.add('hidden');
        document.body.classList.remove('mobile-menu-open');
        menuToggle?.setAttribute('aria-expanded', 'false');
      }
    }

    menuToggle?.addEventListener('click', (e) => {
      e.preventDefault();
      toggleMenu();
    });

    // Close on link click
    mobileMenu?.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        if (isOpen) toggleMenu();
      });
    });

    // Close on escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && isOpen) toggleMenu();
    });
  });
</script>

<style>
  /* Header */
  .nav-header {
    position: sticky;
    top: 0;
    z-index: 50;
    background: rgba(12, 18, 32, 0.8);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }

  /* Logo */
  .nav-logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    text-decoration: none;
    color: var(--color-white);
    transition: all 0.2s ease;
  }

  .nav-logo:hover {
    color: var(--color-accent-primary);
  }

  .logo-icon {
    color: var(--color-accent-primary);
    transition: transform 0.2s ease;
  }

  .nav-logo:hover .logo-icon {
    transform: scale(1.05);
  }

  .logo-text {
    font-family: var(--font-display);
    font-size: 1.125rem;
    font-weight: 700;
    letter-spacing: 0.05em;
  }

  /* Navigation links */
  .nav-link {
    display: flex;
    align-items: center;
    padding: 0.5rem 0.875rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-light-slate);
    text-decoration: none;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
    background: transparent;
    border: none;
    cursor: pointer;
  }

  .nav-link:hover {
    color: var(--color-white);
    background: rgba(255, 255, 255, 0.05);
  }

  .nav-link[aria-current="page"] {
    color: var(--color-accent-primary);
    background: rgba(0, 229, 191, 0.1);
  }

  /* Dropdown */
  .nav-dropdown {
    position: relative;
  }

  .nav-dropdown-trigger svg {
    transition: transform 0.2s ease;
  }

  .nav-dropdown:hover .nav-dropdown-trigger svg {
    transform: rotate(180deg);
  }

  .nav-dropdown-menu {
    position: absolute;
    top: 100%;
    right: 0;
    margin-top: 0.5rem;
    min-width: 160px;
    background: rgba(16, 24, 40, 0.95);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 0.75rem;
    padding: 0.5rem;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-8px);
    transition: all 0.2s ease;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
  }

  .nav-dropdown:hover .nav-dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .nav-dropdown-item {
    display: block;
    padding: 0.625rem 0.875rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-light-slate);
    text-decoration: none;
    border-radius: 0.5rem;
    transition: all 0.15s ease;
  }

  .nav-dropdown-item:hover {
    color: var(--color-white);
    background: rgba(255, 255, 255, 0.05);
  }

  .nav-dropdown-item[aria-current="page"] {
    color: var(--color-accent-primary);
  }

  /* GitHub link */
  .nav-github {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.25rem;
    height: 2.25rem;
    color: var(--color-light-slate);
    border-radius: 0.5rem;
    transition: all 0.2s ease;
  }

  .nav-github:hover {
    color: var(--color-white);
    background: rgba(255, 255, 255, 0.05);
  }

  /* Mobile toggle */
  .nav-mobile-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    color: var(--color-light-slate);
    background: transparent;
    border: none;
    border-radius: 0.5rem;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .nav-mobile-toggle:hover {
    color: var(--color-white);
    background: rgba(255, 255, 255, 0.05);
  }

  /* Mobile menu */
  .mobile-menu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: rgba(12, 18, 32, 0.98);
    backdrop-filter: blur(16px);
    border-top: 1px solid rgba(255, 255, 255, 0.05);
    max-height: calc(100vh - 4rem);
    overflow-y: auto;
  }

  .mobile-menu.open {
    display: block;
  }

  .mobile-menu-content {
    padding: 1rem;
  }

  .mobile-menu-section {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .mobile-menu-link {
    display: block;
    padding: 0.875rem 1rem;
    font-size: 1rem;
    font-weight: 500;
    color: var(--color-light-slate);
    text-decoration: none;
    border-radius: 0.5rem;
    transition: all 0.15s ease;
  }

  .mobile-menu-link:hover {
    color: var(--color-white);
    background: rgba(255, 255, 255, 0.05);
  }

  .mobile-menu-link[aria-current="page"] {
    color: var(--color-accent-primary);
    background: rgba(0, 229, 191, 0.1);
  }

  .mobile-menu-footer {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid rgba(255, 255, 255, 0.05);
  }

  .mobile-menu-cta {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    width: 100%;
    padding: 0.875rem 1rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-midnight-navy);
    background: var(--color-accent-primary);
    text-decoration: none;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
  }

  .mobile-menu-cta:hover {
    background: var(--color-accent-glow);
  }

  /* Body scroll lock */
  body.mobile-menu-open {
    overflow: hidden;
  }

  @media (min-width: 1024px) {
    .mobile-menu {
      display: none !important;
    }
  }
</style> 